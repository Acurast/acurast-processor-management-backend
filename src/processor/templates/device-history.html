<!doctype html>
<html>
  <head>
    <title>Device History</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 20px;
        background-color: #f5f5f5;
      }
      .container {
        max-width: 1200px;
        margin: 0 auto;
        background-color: white;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }
      h1 {
        color: #333;
        margin-bottom: 20px;
      }
      .device-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
        padding-bottom: 15px;
        border-bottom: 1px solid #eee;
      }
      .device-address {
        font-weight: bold;
        color: #2c3e50;
        font-size: 1.2em;
      }
      .history-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 20px;
      }
      .history-card {
        background-color: #fff;
        border: 1px solid #ddd;
        border-radius: 8px;
        padding: 15px;
        transition: transform 0.2s;
      }
      .history-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      }
      .timestamp {
        color: #666;
        font-size: 0.9em;
        margin-bottom: 10px;
      }
      .info-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 10px;
      }
      .info-section {
        background-color: #f8f9fa;
        padding: 10px;
        border-radius: 6px;
      }
      .info-title {
        font-weight: 500;
        color: #2c3e50;
        margin-bottom: 5px;
        font-size: 0.9em;
      }
      .info-value {
        color: #555;
        font-size: 1em;
      }
      .battery-section {
        display: flex;
        align-items: center;
        gap: 5px;
      }
      .battery-icon {
        width: 16px;
        height: 16px;
      }
      .temperature-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
        gap: 5px;
      }
      .temperature-item {
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 5px;
        background-color: #fff;
        border-radius: 4px;
        box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
      }
      .temperature-label {
        font-size: 0.8em;
        color: #666;
        margin-bottom: 2px;
      }
      .temperature-value {
        font-size: 0.9em;
        font-weight: 500;
        color: #2c3e50;
      }
      .error-message {
        color: #e74c3c;
        text-align: center;
        padding: 20px;
        background-color: #fde8e8;
        border-radius: 8px;
        margin: 20px 0;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>Device History</h1>
      {{#if error}}
      <div class="error-message">{{error}}</div>
      {{else}}
      <div class="device-header">
        <span class="device-address">{{deviceAddress}}</span>
      </div>
      <div class="history-grid">
        {{#each history}}
        <div class="history-card">
          <div class="timestamp">{{formatTimestamp timestamp}}</div>
          <div class="info-grid">
            <div class="info-section">
              <div class="info-title">Battery Status</div>
              <div class="battery-section">
                {{#if isCharging}}
                <img
                  src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9IiM2Y2JjM2QiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIj48cGF0aCBkPSJNMjEgMTBoLTJhMiAyIDAgMCAwLTIgMnY2YTIgMiAwIDAgMCAyIDJoMWEyIDIgMCAwIDAgMi0ydi0yIi8+PHBhdGggZD0iTTExIDZWNmEyIDIgMCAwIDEtMi0yVjJhMiAyIDAgMCAxIDItMmg2YTIgMiAwIDAgMSAyIDJ2MmEyIDIgMCAwIDEtMiAydjBhMiAyIDAgMCAxLTIgMkgxM2EyIDIgMCAwIDEtMi0yeiIvPjxwYXRoIGQ9Ik0xMSAxMHY0YTIgMiAwIDAgMCAyIDJoMmEyIDIgMCAwIDAgMi0ydi00Ii8+PHBhdGggZD0iTTExIDEwaDIiLz48L3N2Zz4="
                  class="battery-icon"
                  alt="Charging"
                />
                {{else}}
                <img
                  src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9IiM2Y2JjM2QiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIj48cGF0aCBkPSJNMjEgMTBoLTJhMiAyIDAgMCAwLTIgMnY2YTIgMiAwIDAgMCAyIDJoMWEyIDIgMCAwIDAgMi0ydi0yIi8+PHBhdGggZD0iTTExIDZWNmEyIDIgMCAwIDEtMi0yVjJhMiAyIDAgMCAxIDItMmg2YTIgMiAwIDAgMSAyIDJ2MmEyIDIgMCAwIDEtMiAydjBhMiAyIDAgMCAxLTIgMkgxM2EyIDIgMCAwIDEtMi0yeiIvPjxwYXRoIGQ9Ik0xMSAxMHY0YTIgMiAwIDAgMCAyIDJoMmEyIDIgMCAwIDAgMi0ydi00Ii8+PC9zdmc+"
                  class="battery-icon"
                  alt="Battery"
                />
                {{/if}}
                <span class="info-value">{{batteryLevel}}%</span>
              </div>
              {{#if batteryHealth}}
              <div class="info-value">Health: {{batteryHealth}}</div>
              {{/if}}
            </div>
            <div class="info-section">
              <div class="info-title">Network</div>
              <div class="info-value">{{networkType}}</div>
              {{#if ssid}}
              <div class="info-value">{{ssid}}</div>
              {{/if}}
            </div>
            <div class="info-section">
              <div class="info-title">Temperature</div>
              <div class="temperature-grid">
                {{#each temperature}} {{#if this}}
                <div class="temperature-item">
                  <span class="temperature-label">{{@key}}</span>
                  <span class="temperature-value">{{this}}Â°C</span>
                </div>
                {{/if}} {{/each}}
              </div>
            </div>
          </div>
        </div>
        {{/each}}
      </div>
      {{/if}}
    </div>
  </body>
</html>
